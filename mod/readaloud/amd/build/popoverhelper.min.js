define(["jquery","core/log","mod_readaloud/loader","theme_boost/popover"],function(a,b){"use strict";return b.debug("Readaloud Popover helper: initialising"),{lastitem:!1,okbuttonclass:"mod_readaloud_quickgrade_ok",ngbuttonclass:"mod_readaloud_quickgrade_ng",dispose:!1,init:function(){this.register_events()},register_events:function(){a(document).on("click","."+this.okbuttonclass,this.onAccept),a(document).on("click","."+this.ngbuttonclass,this.onReject)},disposeWord:function(){if(this.dispose)return this.dispose;if(a.fn.popover.Constructor.hasOwnProperty("VERSION"))var b=a.fn.popover.Constructor.VERSION.charAt(0);else var b="3";switch(b){case"4":this.dispose="dispose";break;case"3":default:this.dispose="destroy"}return this.dispose},remove:function(b){b?a(b).popover(this.disposeWord()):this.lastitem&&(a(this.lastitem).popover(this.disposeWord()),this.lastitem=!1)},addQuickGrader:function(b){this.lastitem&&this.lastitem!==b&&(a(this.lastitem).popover(this.disposeWord()),this.lastitem=!1),this.lastitem=b;var c=this,d=function(){var b=a(this).attr("data-wordnumber"),d=M.util.get_string("ok","mod_readaloud"),e=M.util.get_string("ng","mod_readaloud"),f="<button type='button' class='btn "+c.okbuttonclass+"' data-wordnumber='"+b+"'><i class='fa fa-check'></i> "+d+"</button>",g="<button type='button' class='btn "+c.ngbuttonclass+"' data-wordnumber='"+b+"'><i class='fa fa-close'></i> "+e+"</button>",h="<div class='mod_readaloud_quickgrade_cont'>"+f+g+"</div>";return h};a(b).popover({title:M.util.get_string("quickgrade","mod_readaloud"),content:d,trigger:"manual",placement:"top",html:!0}),a(b).popover("show")},addTranscript:function(b,c){return this.lastitem==b?(a(this.lastitem).popover(this.disposeWord()),void(this.lastitem=!1)):(this.lastitem&&(a(this.lastitem).popover(this.disposeWord()),this.lastitem=!1),this.lastitem=b,a(b).popover({title:M.util.get_string("transcript","mod_readaloud"),content:c,trigger:"manual",placement:"top"}),void a(b).popover("show"))},onAccept:function(){alert(a(this).attr("data-wordnumber"))},onReject:function(){alert(a(this).attr("data-wordnumber"))}}});